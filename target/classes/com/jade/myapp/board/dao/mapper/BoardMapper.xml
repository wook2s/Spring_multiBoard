<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="com.jade.myapp.board.dao.IBoardRepository">

	<select id="getAllBoardListByCategory" parameterType="map" resultType="com.jade.myapp.board.model.Board">
	<![CDATA[
		SELECT 
			BOARD_ID 	AS "boardId",
			CATEGORY_ID AS "categoryId",
			ID 			AS "id",
			CONTENT 	AS "content",
			WRITE_DATE 	AS "writeDate",
			READ_COUNT 	AS "readCount",
			REPLY_NUM 	AS "replyNum",
			TITLE 		AS "title"
		FROM 
	    	(
	    	 SELECT ROWNUM RNUM, BOARD_ID, CATEGORY_ID, ID, CONTENT, WRITE_DATE, READ_COUNT, REPLY_NUM, TITLE FROM (SELECT * FROM S_BOARD WHERE CATEGORY_ID=#{categoryId} ORDER BY BOARD_ID DESC) ORDER BY BOARD_ID DESC
	    	)
		WHERE 
			RNUM BETWEEN #{startPage} AND #{endPage}
	]]>
	</select>
	
	<select id="getBoard" parameterType="map" resultType="com.jade.myapp.board.model.Board">
	<![CDATA[
		SELECT 
			BOARD_ID 	AS "boardId",
			CATEGORY_ID AS "categoryId",
			ID 			AS "id",
			CONTENT 	AS "content",
			WRITE_DATE 	AS "writeDate",
			READ_COUNT 	AS "readCount",
			REPLY_NUM 	AS "replyNum",
			TITLE 		AS "title"
		FROM
		    S_BOARD
		WHERE BOARD_ID = #{boardId}  
	]]>
	</select>
	
	<update id="addReadCount" parameterType="map">
		UPDATE
			S_BOARD
    	SET 
    		READ_COUNT = READ_COUNT+1
    	WHERE 
    		BOARD_ID = #{boardId}
	</update>

</mapper>